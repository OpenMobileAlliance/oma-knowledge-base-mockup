import { defineEventHandler, sendRedirect } from "h3";
import { withBase } from "ufo";
import { useSitemapRuntimeConfig } from "../utils.js";
import { createSitemap } from "../sitemap/nitro.js";
import { useRuntimeConfig } from "#imports";
export default defineEventHandler(async (e) => {
  const runtimeConfig = useSitemapRuntimeConfig();
  const { sitemaps } = runtimeConfig;
  if ("index" in sitemaps) {
    return sendRedirect(e, withBase("/sitemap_index.xml", useRuntimeConfig().app.baseURL), import.meta.dev ? 302 : 301);
  }
  return createSitemap(e, Object.values(sitemaps)[0], runtimeConfig);
});
